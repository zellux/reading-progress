{% extends "base.html" %}
{% block header %}
<script type="text/javascript" src="js/swfobject.js"></script>
<script type="text/javascript" src="js/jquery.progressbar.min.js"></script>
{% endblock %}

{% block title %}{{ user.uname }} 的书籍{% endblock %}

{% block bodycontent %}
<script type="text/javascript">
  function showChart(url) {
  swfobject.embedSWF(
  "swf/OFC.swf", "my_chart",
  "550", "300", "9.0.0", "swf/expressInstall.swf",
  {"data-file":url, "loading":"图表生成中..."});
  }
</script>

<!-- navigator -->
<div class="navi"></div>

<!-- prev link -->
<a class="prev"></a>

<div class="scrollable">
  <div id="thumbs">
    {% for book in books %}
    <div class="bookitem" id="{{ book.key }}">
      <div class="cover"><img src="{{ book.img }}" /></div>
      <h3><em>{{ forloop.counter }}.</em>{{ book.title }}</h3>
      <div class="option">
		<div>修改进度</div>
		<!-- <div><a href="/randomProgress?book={{ book.key }}">随机进度生成</a></div> -->
		<!-- <div><a href="/showProgress?book={{ book.key }}">查看进度</a></div> -->
	  </div>
	  <div id="pbar{{ forloop.counter }}" class="progressBar"></div>
    </div>
  {% endfor %}
  </div>
</div>

<!-- next link -->
<a class="next"></a>

<br clear="all" />
<div id="my_chart"></div>


<script>
$(document).ready(function() {
{% for book in books %}
 $("#pbar{{ forloop.counter }}").progressBar({{ book.done }},{
max: {{ book.pages }},
textFormat: 'fraction',
boxImage:'/img/pbar/progressbar.gif',
barImage:{0:'/img/pbar/progressbg_red.gif',{% widthratio book.pages 10 3 %}:'/img/pbar/progressbg_orange.gif',{% widthratio book.pages 10 7 %}:'/img/pbar/progressbg_green.gif'}
});
{% endfor %}
});


// execute your scripts when DOM is ready. this is a good habit 
$(function() {         
         
    // initialize scrollable  
    var api = $("div.scrollable").scrollable({
        api: true,
        size: 3, 
        items: '#thumbs',   
        hoverClass: 'hover' 
    });

    $("div.bookitem").click(function() {
        bkey = $(this).attr("id");
        showChart("/getOFCData?key=" + bkey);
    });
}); 
</script>

{% endblock %}
